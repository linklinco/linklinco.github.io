{"title": "Docker学习笔记", "topic": "运维", "time": "20210311", "label": ["docker", "linux", "测试"], "needPassword": false, "text": "## Docker学习笔记\n\n### 1、命令行格式\n\n```shell\n docker run ubuntu:15.10 /bin/echo \"hello world\"\n```\n\n各个参数解析：\n\n- **docker:** Docker 的二进制执行文件。\n- **run:** 与前面的 docker 组合来运行一个容器。\n- **ubuntu:15.10** 指定要运行的镜像，Docker 首先从本地主机上查找镜像是否存在，如果不存在，Docker 就会从镜像仓库 Docker Hub 下载公共镜像。\n- **/bin/echo \"Hello world\":** 在启动的容器里执行的命令\n\n以上命令完整的意思可以解释为：Docker 以 ubuntu15.10 镜像创建一个新容器，然后在容器里执行 bin/echo \"Hello world\"，然后输出结果。\n\n####  运行交互式的容器\n\n我们通过 docker 的两个参数 -i -t，让 docker 运行的容器实现**\"对话\"**的能力：\n\n```\nrunoob@runoob:~$ docker run -i -t ubuntu:15.10 /bin/bash\nroot@0123ce188bd8:/#\n```\n\n各个参数解析：\n\n- **-t:** 在新容器内指定一个伪终端或终端。\n- **-i:** 允许你对容器内的标准输入 (STDIN) 进行交互。\n- **-d**:在后台以进程方式运行容器\n\n```\nexit  退出\n```\n\n#### 查看docker的运行情况\n\n```\ndocker ps\nCONTAINER ID   IMAGE          COMMAND       CREATED         STATUS         PORTS     \n2398c314f9ac   ubuntu:15.10   \"/bin/bash\"   2 minutes ago   Up 2 minutes             \nNAMES\nmagical_wiles\n\n```\n\n输出详情介绍：\n\n**CONTAINER ID:** 容器 ID。\n\n**IMAGE:** 使用的镜像。\n\n**COMMAND:** 启动容器时运行的命令。\n\n**CREATED:** 容器的创建时间。\n\n**STATUS:** 容器状态。\n\n状态有7种：\n\n- created（已创建）\n- restarting（重启中）\n- running 或 Up（运行中）\n- removing（迁移中）\n- paused（暂停）\n- exited（停止）\n- dead（死亡）\n\n**PORTS:** 容器的端口信息和使用的连接类型（tcp\\udp）。\n\n**NAMES:** 自动分配的容器名称。\n\n在宿主主机内使用 **docker logs** 命令，查看容器内的标准输出：\n\n```\nrunoob@runoob:~$ docker logs 2b1b7a428627\n```\n\n#### 停止容器\n\n我们使用 **docker stop** 命令来停止容器\n\n### 2、docker容器的使用\n\n#### 获取镜像\n\n如果我们本地没有 ubuntu 镜像，我们可以使用 docker pull 命令来载入 ubuntu 镜像：\n\n```\n$ docker pull ubuntu\n```\n\n#### 启动容器\n\n以下命令使用 ubuntu 镜像启动一个容器，参数为以命令行模式进入该容器：\n\n```\n$ docker run -it ubuntu /bin/bash\n```\n\n#### 进入容器\n\n在使用 **-d** 参数时，容器启动后会进入后台。此时想要进入容器，可以通过以下指令进入：\n\n- **docker attach**\n- **docker exec**：推荐大家使用 docker exec 命令，因为此退出容器终端，不会导致容器的停止。\n\n**attach 命令**\n\n下面演示了使用 docker attach 命令。\n\n```\n$ docker attach 1e560fca3906 \n```\n\n[![img](https://www.runoob.com/wp-content/uploads/2016/05/docker-attach.png)](https://www.runoob.com/wp-content/uploads/2016/05/docker-attach.png)\n\n**注意：** 如果从这个容器退出，会导致容器的停止。\n\n**exec 命令**\n\n下面演示了使用 docker exec 命令。\n\n```\ndocker exec -it 243c32535da7 /bin/bash\n```\n\n[![img](https://www.runoob.com/wp-content/uploads/2016/05/docker-exec.png)](https://www.runoob.com/wp-content/uploads/2016/05/docker-exec.png)\n\n**注意：** 如果从这个容器退出，容器不会停止，这就是为什么推荐大家使用 **docker exec** 的原因。\n\n更多参数说明请使用 **docker exec --help** 命令查看。\n\n\n\n### 3、导出和导入容器\n\n**导出容器**\n\n如果要导出本地某个容器，可以使用 **docker export** 命令。\n\n```\n$ docker export 1e560fca3906 > ubuntu.tar\n```\n\n导出容器 1e560fca3906 快照到本地文件 ubuntu.tar。\n\n[![img](https://www.runoob.com/wp-content/uploads/2016/05/docker-export.png)](https://www.runoob.com/wp-content/uploads/2016/05/docker-export.png)\n\n这样将导出容器快照到本地文件。\n\n**导入容器快照**\n\n可以使用 docker import 从容器快照文件中再导入为镜像，以下实例将快照文件 ubuntu.tar 导入到镜像 test/ubuntu:v1:\n\n```\n$ cat docker/ubuntu.tar | docker import - test/ubuntu:v1\n```\n\n[![img](https://www.runoob.com/wp-content/uploads/2016/05/docker-import.png)](https://www.runoob.com/wp-content/uploads/2016/05/docker-import.png)\n\n此外，也可以通过指定 URL 或者某个目录来导入，例如：\n\n```\n$ docker import http://example.com/exampleimage.tgz example/imagerepo\n```\n\n### 删除容器\n\n删除容器使用 **docker rm** 命令：\n\n```\n$ docker rm -f 1e560fca3906\n```\n\n[![img](https://www.runoob.com/wp-content/uploads/2016/05/docker-container-rmi.png)](https://www.runoob.com/wp-content/uploads/2016/05/docker-container-rmi.png)\n\n下面的命令可以清理掉所有处于终止状态的容器。\n\n$ docker container prune\n\n\n\n在要保存 .tar 镜像的机器上运行：\n\n```\ndocker save -o [image].tar\n```\n\n在需要上传的机器上运行：\n\n```\ndocker load -i [image].tar\n```"}